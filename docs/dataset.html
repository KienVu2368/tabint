---

title: Dataset class

keywords: fastai
sidebar: home_sidebar

summary: "convert data into tabular dataset "
description: "convert data into tabular dataset "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_dataset.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TBDataset" class="doc_header"><code>class</code> <code>TBDataset</code><a href="https://github.com/ddpham/tabint/tree/master/tabint/dataset.py#L22" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TBDataset</code>(<strong><code>x_trn</code></strong>, <strong><code>x_val</code></strong>, <strong><code>x_tst</code></strong>, <strong><code>x_tfms</code></strong>, <strong><code>y_trn</code></strong>, <strong><code>y_val</code></strong>, <strong><code>y_tfms</code></strong>)</p>
</blockquote>
<p>Contain train, validation, test set</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="random_choose" class="doc_header"><code>random_choose</code><a href="https://github.com/ddpham/tabint/tree/master/tabint/dataset.py#L160" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>random_choose</code>(<strong><code>x</code></strong>, <strong><code>pct</code></strong>=<em><code>0.1</code></em>, <strong><code>ratio</code></strong>=<em><code>0.2</code></em>, <strong>**<code>kargs</code></strong>)</p>
</blockquote>
<p>static method for from_TBSplit, random choose rows from a group</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="stratify_split" class="doc_header"><code>stratify_split</code><a href="https://github.com/ddpham/tabint/tree/master/tabint/dataset.py#L168" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>stratify_split</code>(<strong><code>df</code></strong>, <strong><code>y</code></strong>, <strong><code>cats</code></strong>, <strong><code>ratio</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_time_series" class="doc_header"><code>split_time_series</code><a href="https://github.com/ddpham/tabint/tree/master/tabint/dataset.py#L180" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_time_series</code>(<strong><code>df</code></strong>, <strong><code>time_feature</code></strong>, <strong><code>ratio</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="split_by_cats" class="doc_header"><code>class</code> <code>split_by_cats</code><a href="https://github.com/ddpham/tabint/tree/master/tabint/dataset.py#L189" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>split_by_cats</code>(<strong><code>n_splits</code></strong>=<em><code>10</code></em>, <strong><code>test_size</code></strong>=<em><code>None</code></em>, <strong><code>train_size</code></strong>=<em><code>None</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>) :: <code>StratifiedShuffleSplit</code></p>
</blockquote>
<p>Stratified ShuffleSplit cross-validator</p>
<p>Provides train/test indices to split data in train/test sets.</p>
<p>This cross-validation object is a merge of StratifiedKFold and
ShuffleSplit, which returns stratified randomized folds. The folds
are made by preserving the percentage of samples for each class.</p>
<p>Note: like the ShuffleSplit strategy, stratified random splits
do not guarantee that all folds will be different, although this is
still very likely for sizeable datasets.</p>
<p>Read more in the :ref:<code>User Guide &lt;cross_validation&gt;</code>.</p>
<h2 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h2><p>n_splits : int, default=10
    Number of re-shuffling &amp; splitting iterations.</p>
<p>test_size : float or int, default=None
    If float, should be between 0.0 and 1.0 and represent the proportion
    of the dataset to include in the test split. If int, represents the
    absolute number of test samples. If None, the value is set to the
    complement of the train size. If <code>train_size</code> is also None, it will
    be set to 0.1.</p>
<p>train_size : float or int, default=None
    If float, should be between 0.0 and 1.0 and represent the
    proportion of the dataset to include in the train split. If
    int, represents the absolute number of train samples. If None,
    the value is automatically set to the complement of the test size.</p>
<p>random_state : int or RandomState instance, default=None
    Controls the randomness of the training and testing indices produced.
    Pass an int for reproducible output across multiple function calls.
    See :term:<code>Glossary &lt;random_state&gt;</code>.</p>
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2><blockquote><blockquote><blockquote><p>import numpy as np
from sklearn.model_selection import StratifiedShuffleSplit
X = np.array([[1, 2], [3, 4], [1, 2], [3, 4], [1, 2], [3, 4]])
y = np.array([0, 0, 0, 1, 1, 1])
sss = StratifiedShuffleSplit(n_splits=5, test_size=0.5, random_state=0)
sss.get_n_splits(X, y)
5
print(sss)
StratifiedShuffleSplit(n_splits=5, random_state=0, ...)
for train_index, test_index in sss.split(X, y):
...     print("TRAIN:", train_index, "TEST:", test_index)
...     X_train, X_test = X[train_index], X[test_index]
...     y_train, y_test = y[train_index], y[test_index]
TRAIN: [5 2 3] TEST: [4 1 0]
TRAIN: [5 1 4] TEST: [0 2 3]
TRAIN: [5 0 2] TEST: [4 3 1]
TRAIN: [4 1 0] TEST: [2 3 5]
TRAIN: [0 5 1] TEST: [3 4 2]</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_utils.ipynb.
Converted 01_pre-processing.ipynb.
Converted 03_transform.ipynb.
Converted 04_dataset.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

