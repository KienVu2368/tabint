---

title: Welcom to Tabint

keywords: fastai
sidebar: home_sidebar

summary: "NB: this is on development process, many things we want to develop but have not yet done. If you want to contribute please feel free to do so."
description: "NB: this is on development process, many things we want to develop but have not yet done. If you want to contribute please feel free to do so."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installing">Installing<a class="anchor-link" href="#Installing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>git clone https://github.com/KienVu2368/tabint
cd tabint
conda env create -f environment.yml
conda activate tabint</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pre-processing">Pre-processing<a class="anchor-link" href="#Pre-processing"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;df_sample.csv&#39;</span><span class="p">)</span>
<span class="n">df_proc</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">pp_outp</span> <span class="o">=</span> <span class="n">tabular_proc</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;TARGET&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">fill_na</span><span class="p">(),</span> <span class="n">app_cat</span><span class="p">(),</span> <span class="n">dummies</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unify class for pre processing class.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">cls</span><span class="p">(</span><span class="n">TBPreProc</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pp_outp</span><span class="p">,</span> <span class="n">na_dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example, fill_na class</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">fill_na</span><span class="p">(</span><span class="n">TBPreProc</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pp_outp</span><span class="p">,</span> <span class="n">na_dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">na_dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">na_dict</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">na_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">na_dict_initial</span> <span class="o">=</span> <span class="n">na_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="n">na_dict</span> <span class="o">=</span> <span class="n">fix_missing</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">na_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">na_dict_initial</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="n">a</span> <span class="o">+</span> <span class="s1">&#39;_na&#39;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">na_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">na_dict_initial</span><span class="o">.</span><span class="n">keys</span><span class="p">()))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pp_outp</span><span class="p">[</span><span class="s1">&#39;na_dict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">na_dict</span>
        <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataset">Dataset<a class="anchor-link" href="#Dataset"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataset class contain training set, validation set and test set.</p>
<p>Dataset can be built by split method of SKlearn</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">TBDataset</span><span class="o">.</span><span class="n">from_SKSplit</span><span class="p">(</span><span class="n">df_proc</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cons</span><span class="p">,</span> <span class="n">cats</span><span class="p">,</span> <span class="n">ratio</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or by split method of tabint. This method will try to keep the same distribution of categorie variables between training set and validation set.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">TBDataset</span><span class="o">.</span><span class="n">from_TBSplit</span><span class="p">(</span><span class="n">df_proc</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cons</span><span class="p">,</span> <span class="n">cats</span><span class="p">,</span> <span class="n">ratio</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataset class have method that can simultaneously edit training set, validation set and test set.</p>
<p>Drop method can drop one or many columns in training set, validation set and test set.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;DAYS_LAST_PHONE_CHANGE_na&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or if we need to keep only importance columns that we found above. Just use keep method from dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpt_features</span> <span class="o">=</span> <span class="n">impt</span><span class="o">.</span><span class="n">top_features</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">keep</span><span class="p">(</span><span class="n">impt_features</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dataset class in tabint also can simultaneously apply a funciton to training set, validation set and test set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;DAYS_BIRTH&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAYS_BIRTH&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">365</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or we can pass many transformation function at once.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfs</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;drop 1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AMT_REQ_CREDIT_BUREAU_HOUR_na&#39;</span><span class="p">,</span> <span class="s1">&#39;AMT_REQ_CREDIT_BUREAU_YEAR_na&#39;</span><span class="p">],</span>
    
        <span class="s1">&#39;apply&#39;</span><span class="p">:{</span><span class="s1">&#39;DAYS_BIRTH&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAYS_BIRTH&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span>
                 <span class="s1">&#39;DAYS_EMPLOYED&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAYS_EMPLOYED&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">365</span><span class="p">,</span>
                 <span class="s1">&#39;NEW_EXT_SOURCES_MEAN&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;EXT_SOURCE_1&#39;</span><span class="p">,</span> <span class="s1">&#39;EXT_SOURCE_2&#39;</span><span class="p">,</span> <span class="s1">&#39;EXT_SOURCE_3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                 <span class="s1">&#39;NEW_EXT_SOURCES_GEO&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EXT_SOURCE_1&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EXT_SOURCE_2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EXT_SOURCE_3&#39;</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span>
                 <span class="s1">&#39;AMT_CREDIT/AMT_GOODS_PRICE&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AMT_CREDIT&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AMT_GOODS_PRICE&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;AMT_CREDIT/AMT_CREDIT&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AMT_CREDIT&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AMT_CREDIT&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;DAYS_EMPLOYED/DAYS_BIRTH&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAYS_EMPLOYED&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAYS_BIRTH&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;DAYS_BIRTH*EXT_SOURCE_1_na&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAYS_BIRTH&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;EXT_SOURCE_1_na&#39;</span><span class="p">]},</span>
    
        <span class="s1">&#39;drop 2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AMT_ANNUITY&#39;</span><span class="p">,</span> <span class="s1">&#39;AMT_CREDIT&#39;</span><span class="p">,</span> <span class="s1">&#39;AMT_GOODS_PRICE&#39;</span><span class="p">]}</span>

<span class="n">ds</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">tfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Learner">Learner<a class="anchor-link" href="#Learner"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Learner class unify training method from sklearn model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span> <span class="o">=</span> <span class="n">LGBLearner</span><span class="p">()</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="s1">&#39;metric&#39;</span><span class="p">:</span><span class="s1">&#39;binary_logloss&#39;</span><span class="p">}</span>
<span class="n">learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="o">*</span><span class="n">ds</span><span class="o">.</span><span class="n">trn</span><span class="p">,</span> <span class="o">*</span><span class="n">ds</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>LGBM model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learner</span> <span class="o">=</span> <span class="n">SKLearner</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">())</span>
<span class="n">learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">ds</span><span class="o">.</span><span class="n">trn</span><span class="p">,</span> <span class="o">*</span><span class="n">ds</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and XGB model (WIP)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-correlation">Feature correlation<a class="anchor-link" href="#Feature-correlation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>tabint use đenogram for easy to see and pick features with high correlation</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ddg</span> <span class="o">=</span> <span class="n">Dendogram</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">x_trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ddg</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-importance">Feature importance<a class="anchor-link" href="#Feature-importance"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>tabint use <a href="https://explained.ai/rf-importance/index.html">permutation importance</a>. Each column or group of columns in validation set in dataset will be permute to calculate the importance.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">group_cols</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;AMT_CREDIT&#39;</span><span class="p">,</span> <span class="s1">&#39;AMT_GOODS_PRICE&#39;</span><span class="p">,</span> <span class="s1">&#39;AMT_ANNUITY&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;FLAG_OWN_CAR_N&#39;</span><span class="p">,</span> <span class="s1">&#39;OWN_CAR_AGE_na&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">impt</span> <span class="o">=</span> <span class="n">Importance</span><span class="o">.</span><span class="n">from_Learner</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="p">,</span> <span class="n">group_cols</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">impt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can easily get the most importance feature by method in Importance class</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">impt</span><span class="o">.</span><span class="n">top_features</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-performance">Model performance<a class="anchor-link" href="#Model-performance"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Classification-problem">Classification problem<a class="anchor-link" href="#Classification-problem"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Receiver-operating-characteristic">Receiver operating characteristic<a class="anchor-link" href="#Receiver-operating-characteristic"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">roc</span> <span class="o">=</span> <span class="n">ReceiverOperatingCharacteristic</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">roc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Probability-distribution">Probability distribution<a class="anchor-link" href="#Probability-distribution"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kde</span> <span class="o">=</span> <span class="n">KernelDensityEstimation</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">kde</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Precision-and-Recall">Precision and Recall<a class="anchor-link" href="#Precision-and-Recall"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">PrecisionRecall</span><span class="o">.</span><span class="n">from_series</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">pr</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Regression-problem">Regression problem<a class="anchor-link" href="#Regression-problem"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Actual-vs-Predict">Actual vs Predict<a class="anchor-link" href="#Actual-vs-Predict"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">avp</span> <span class="o">=</span> <span class="n">actual_vs_predict</span><span class="o">.</span><span class="n">from_learner</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">avp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Height&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Interpretation-and-explaination">Interpretation and explaination<a class="anchor-link" href="#Interpretation-and-explaination"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Partial-dependence">Partial dependence<a class="anchor-link" href="#Partial-dependence"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>tabint use <a href="https://github.com/SauceCat/PDPbox">PDPbox</a> library to visualize partial dependence.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdp</span> <span class="o">=</span> <span class="n">PartialDependence</span><span class="o">.</span><span class="n">from_Learner</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="info-target-plot">info target plot<a class="anchor-link" href="#info-target-plot"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdp</span><span class="o">.</span><span class="n">info_target_plot</span><span class="p">(</span><span class="s1">&#39;EXT_SOURCE_3&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see result as table</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdp</span><span class="o">.</span><span class="n">info_target_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="isolate-plot">isolate plot<a class="anchor-link" href="#isolate-plot"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdp</span><span class="o">.</span><span class="n">isolate_plot</span><span class="p">(</span><span class="s1">&#39;EXT_SOURCE_3&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tree-interpreter">Tree interpreter<a class="anchor-link" href="#Tree-interpreter"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tf</span> <span class="o">=</span> <span class="n">Traterfall</span><span class="o">.</span><span class="n">from_SKTree</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">x_trn</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">formatting</span> <span class="o">=</span> <span class="s2">&quot;$ </span><span class="si">{:,.3f}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see and filter result table</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">neg</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="SHAP">SHAP<a class="anchor-link" href="#SHAP"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>tabint visual SHAP values from <a href="https://github.com/slundberg/shap">SHAP</a> library. SHAP library use red and blue for default color. tabint change these color to green and blue for easy to see and consistence with pdpbox library.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Shap</span> <span class="o">=</span> <span class="n">SHAP</span><span class="o">.</span><span class="n">from_Tree</span><span class="p">(</span><span class="n">learner</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="force-plot">force plot<a class="anchor-link" href="#force-plot"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Shap</span><span class="o">.</span><span class="n">one_force_plot</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can see table result also.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Shap</span><span class="o">.</span><span class="n">one_force_data</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Shap</span><span class="o">.</span><span class="n">one_force_data</span><span class="o">.</span><span class="n">neg</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="dependence-plot">dependence plot<a class="anchor-link" href="#dependence-plot"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Shap</span><span class="o">.</span><span class="n">dependence_plot</span><span class="p">(</span><span class="s1">&#39;EXT_SOURCE_2&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

